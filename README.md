# 🎨 图像处理编辑器

一个功能强大的前端图像处理应用，基于 React + TypeScript + Vite 构建，提供专业的图像编辑和处理功能。

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![React](https://img.shields.io/badge/React-18.2.0-61dafb.svg)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue.svg)
![Vite](https://img.shields.io/badge/Vite-5.0-646cff.svg)

## ✨ 功能特性

### 📥 图像导入
- ✅ 点击按钮导入
- ✅ 拖拽导入
- ✅ 支持 PNG、JPEG、GIF、WebP 等格式

### 🎛️ 基础调整
- ✅ **亮度调节** (-100% ~ +100%)
- ✅ **对比度调节** (-100% ~ +100%)
- ✅ **饱和度调节** (-100% ~ +100%)
- ✅ **RGB通道独立调节** (R/G/B: -100% ~ +100%)

### 🎨 滤镜效果
- ✅ **灰度化** - 转换为黑白图像
- ✅ **反相** - 颜色反转
- ✅ **模糊** - 可调强度 (0-10px)
- ✅ **锐化** - 可调强度 (0-100%)

### 📊 直方图功能
- ✅ **直方图显示** - RGB + 灰度四通道
- ✅ **直方图均衡** - 增强对比度
  - 亮度模式 - 基于灰度值均衡
  - RGB模式 - 独立均衡三通道
- ✅ **可调强度** (0-100%)

### 🔬 高级图像处理算法

#### 平滑算子（去噪）
- ✅ **中值滤波** - 去除椒盐噪声 (0-3px)
- ✅ **高斯模糊** - 平滑图像 (0-3σ)

#### 锐化算子（增强边缘）
- ✅ **Laplacian 锐化** - 二阶微分锐化

#### 边缘检测算子
- ✅ **Sobel 边缘检测** - 梯度算子
- ✅ **Prewitt 边缘检测** - 简化梯度算子
- ✅ **Roberts 边缘检测** - 快速边缘检测

### 🔄 变换操作
- ✅ **旋转** - 90°、180°、270°
- ✅ **翻转** - 水平/垂直翻转
- ✅ **裁剪** - 自由选择裁剪区域

### 👁️ 视图模式
- ✅ **适配模式** - 自动适应画布
- ✅ **1:1模式** - 原始尺寸显示
- ✅ **填充模式** - 填满画布
- ✅ **对比模式** - 原图/处理后/并排对比

### ⏮️ 历史管理
- ✅ **撤销/重做** - 支持多步操作
- ✅ **重置** - 一键恢复原图
- ✅ **非破坏性编辑** - 基于原图应用调整

### 💾 导出功能
- ✅ **PNG格式** - 无损导出
- ✅ **JPEG格式** - 可调质量
- ✅ **自动命名** - 带时间戳

### ⌨️ 用户体验
- ✅ **键盘快捷键** - Ctrl+Z/Y/S/R
- ✅ **滑块键盘输入** - 精确数值调节
- ✅ **实时预览** - 200ms防抖优化
- ✅ **响应式布局** - 适配不同屏幕

## 🚀 快速开始

### 环境要求
- Node.js >= 16.0.0
- pnpm >= 8.0.0 (推荐) 或 npm >= 8.0.0

### 安装依赖

```bash
# 使用 pnpm (推荐)
pnpm install

# 或使用 npm
npm install
```

### 启动开发服务器

```bash
# 使用 pnpm
pnpm dev

# 或使用 npm
npm run dev
```

访问：http://localhost:5173

### 构建生产版本

```bash
# 使用 pnpm
pnpm build

# 或使用 npm
npm run build
```

### 预览生产版本

```bash
# 使用 pnpm
pnpm preview

# 或使用 npm
npm run preview
```

## 🎯 使用指南

### 基础操作流程

1. **导入图片**
   - 点击"导入"按钮选择图片
   - 或直接拖拽图片到画布

2. **调整图像**
   - 使用左侧滑块调整各项参数
   - 支持键盘输入精确数值
   - 实时预览效果

3. **应用滤镜**
   - 选择需要的滤镜效果
   - 可组合多种滤镜
   - 支持撤销/重做

4. **导出结果**
   - 点击"导出"按钮
   - 选择格式和质量
   - 自动下载到本地

### 滤镜使用建议

#### 去噪处理
```
椒盐噪声 → 中值滤波 (1-2px)
高斯噪声 → 高斯模糊 (0.5-1.5σ)
```

#### 图像增强
```
对比度低 → 直方图均衡 (50-80%)
细节不足 → 锐化 (20-40%)
过度曝光 → 亮度调节 (-30% ~ -50%)
```

#### 边缘检测
```
通用场景 → Sobel 算子
快速检测 → Roberts 算子
平滑边缘 → Prewitt 算子
```

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + Z` | 撤销 |
| `Ctrl + Shift + Z` | 重做 |
| `Ctrl + S` | 导出图片 |
| `Ctrl + R` | 重置图片 |
| `Esc` | 取消裁剪 |
| `↑` / `↓` | 滑块微调 |
| `Enter` | 确认输入 |

## 🏗️ 项目结构

```
src/
├── canvas/                 # Canvas 图像处理核心
│   ├── useCanvas.ts       # Canvas 管理器
│   ├── filters.ts         # 基础滤镜算法
│   ├── advancedFilters.ts # 高级滤镜算法
│   └── history.ts         # 历史记录管理
├── components/            # React 组件
│   ├── Sidebar.tsx        # 侧边栏控制面板
│   ├── Slider.tsx         # 滑块组件
│   ├── Button.tsx         # 按钮组件
│   ├── Toolbar.tsx        # 工具栏
│   ├── Histogram.tsx      # 直方图组件
│   └── CropOverlay.tsx    # 裁剪覆盖层
├── pages/                 # 页面组件
│   └── Editor.tsx         # 主编辑器页面
├── utils/                 # 工具函数
│   └── image.ts           # 图像处理工具
├── App.tsx                # 应用根组件
└── main.tsx               # 应用入口
```

## 🔧 技术栈

### 核心技术
- **React 18** - UI 框架
- **TypeScript** - 类型安全
- **Vite** - 构建工具

### 样式方案
- **Tailwind CSS** - 原子化 CSS

### 图像处理
- **HTML5 Canvas** - 图像渲染
- **Canvas API** - 像素级操作
- **ImageData** - 图像数据处理

### 算法实现
- **卷积算法** - 模糊、锐化、边缘检测
- **直方图算法** - 均衡化、统计分析
- **颜色空间转换** - RGB ↔ HSI
- **几何变换** - 旋转、翻转、裁剪

## 📚 算法说明

### 中值滤波
```
用途：去除椒盐噪声
复杂度：O(n × m × k²)
特点：非线性滤波，保持边缘
```

### 高斯模糊
```
用途：平滑图像，去除高斯噪声
核函数：G(x,y) = exp(-(x²+y²)/(2σ²))
特点：线性滤波，自然平滑
```

### Sobel 边缘检测
```
用途：检测图像边缘
卷积核：Gx = [-1,0,1; -2,0,2; -1,0,1]
        Gy = [-1,-2,-1; 0,0,0; 1,2,1]
梯度：G = √(Gx² + Gy²)
```

### 直方图均衡
```
用途：增强图像对比度
方法：重新分布像素值
公式：h'(i) = round((cdf(i) - cdf_min) / (N - cdf_min) × 255)
```

## 🎨 界面预览

### 主界面
- 左侧：控制面板（调整参数、滤镜选择）
- 右侧：画布区域（实时预览）
- 底部：对比模式切换

### 对比模式
- **处理后**：显示处理后的图像
- **原图**：显示原始图像
- **对比**：上下并排显示，便于对比

## 🚀 部署

### Docker 部署

```bash
# 构建镜像
docker build -t image-editor .

# 运行容器
docker run -p 3000:3000 image-editor

# 或使用 docker-compose
docker-compose up -d
```

### Vercel 部署

1. Fork 本仓库
2. 在 Vercel 中导入项目
3. 自动构建和部署

### Netlify 部署

1. 连接 GitHub 仓库
2. 设置构建命令：`pnpm build`
3. 设置发布目录：`dist`

## 📈 性能优化

### 已实现的优化
- ✅ **防抖处理** - 200ms 防抖，减少计算频率
- ✅ **离屏渲染** - 使用离屏 Canvas 提升性能
- ✅ **参数限制** - 限制滤镜参数范围，避免过度计算
- ✅ **非破坏性编辑** - 基于原图应用调整，避免累积误差

### 性能指标
- 基础调整：< 50ms
- 简单滤镜：< 100ms
- 高级滤镜：< 500ms (1920×1080)
- 边缘检测：< 300ms (1920×1080)

## 🔮 未来计划

### 功能扩展
- [ ] Canny 边缘检测
- [ ] 双边滤波
- [ ] 形态学操作（膨胀、腐蚀）
- [ ] USM 锐化
- [ ] 批量处理
- [ ] 滤镜预设

### 性能优化
- [ ] Web Workers 后台处理
- [ ] 可分离卷积优化
- [ ] GPU 加速（WebGL）
- [ ] 进度条显示

### 用户体验
- [ ] 多语言支持
- [ ] 主题切换
- [ ] 自定义快捷键
- [ ] 操作教程

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

### 开发流程

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

### 代码规范

- 使用 TypeScript
- 遵循 ESLint 规则
- 添加必要的注释
- 编写清晰的提交信息

## 📝 更新日志

### v1.0.0 (2024-11-05)

#### 新增功能
- ✅ 完整的图像编辑功能
- ✅ 多种图像处理算法
- ✅ 直方图显示和均衡
- ✅ RGB/HSI 颜色调节
- ✅ 对比模式查看
- ✅ 键盘快捷键支持

#### 性能优化
- ✅ 防抖优化（200ms）
- ✅ 滤镜参数范围优化
- ✅ 计算量减少 60%+

#### 修复问题
- ✅ 模糊滑块无反应
- ✅ 高级滤镜卡顿
- ✅ 直方图均衡非线性
- ✅ 对比模式图片过小

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 👨‍💻 作者

**Herbal**

## 🙏 致谢

- React 团队
- Vite 团队
- Tailwind CSS 团队
- 数字图像处理经典算法

## 📞 联系方式

- GitHub: [@herbal-rin](https://github.com/herbal-rin)
- 项目地址: [Fast-image-processing](https://github.com/herbal-rin/Fast-image-processing)

---

⭐ 如果这个项目对你有帮助，请给一个 Star！
